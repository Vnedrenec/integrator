# User Stories для MVP

В этом документе описываются пользовательские истории (User Stories) для MVP платформы "BPM Centr".

## Роли пользователей

В системе определены следующие роли пользователей:

1. **Гость** - неавторизованный пользователь
2. **Пользователь** - зарегистрированный и авторизованный пользователь
3. **Администратор** - пользователь с расширенными правами для управления системой

## Приоритеты

Для каждой User Story определен приоритет:

- **P0** - Критически важно для MVP
- **P1** - Важно для MVP
- **P2** - Желательно для MVP
- **P3** - Может быть реализовано после MVP

## Регистрация и аутентификация

### US-1: Регистрация нового пользователя (P0)

**Как** гость,
**Я хочу** зарегистрироваться на платформе,
**Чтобы** получить доступ к коннекторам для Make.

**Критерии приемки:**
1. Пользователь может заполнить форму регистрации с полями: email, пароль, имя, фамилия, компания
2. Система проверяет уникальность email
3. Система проверяет сложность пароля
4. После успешной регистрации пользователь получает email с ссылкой для подтверждения
5. Статус нового пользователя устанавливается как "unverified"

### US-2: Подтверждение email (P0)

**Как** зарегистрированный пользователь,
**Я хочу** подтвердить свой email,
**Чтобы** активировать свою учетную запись.

**Критерии приемки:**
1. Пользователь получает email со ссылкой для подтверждения
2. При переходе по ссылке статус пользователя меняется на "active"
3. Пользователь перенаправляется на страницу входа с сообщением об успешном подтверждении
4. Ссылка для подтверждения имеет ограниченный срок действия (24 часа)

### US-3: Вход в систему (P0)

**Как** зарегистрированный пользователь,
**Я хочу** войти в систему,
**Чтобы** получить доступ к своему аккаунту.

**Критерии приемки:**
1. Пользователь может ввести email и пароль
2. Система проверяет корректность учетных данных
3. При успешной аутентификации пользователь перенаправляется в личный кабинет
4. При неудачной аутентификации пользователь получает сообщение об ошибке
5. Система блокирует вход после 5 неудачных попыток на 15 минут

### US-4: Восстановление пароля (P1)

**Как** зарегистрированный пользователь,
**Я хочу** восстановить забытый пароль,
**Чтобы** получить доступ к своему аккаунту.

**Критерии приемки:**
1. Пользователь может запросить восстановление пароля, указав email
2. Система отправляет email со ссылкой для сброса пароля
3. Ссылка для сброса пароля имеет ограниченный срок действия (1 час)
4. Пользователь может установить новый пароль
5. После установки нового пароля все активные сессии пользователя завершаются

### US-5: Выход из системы (P0)

**Как** авторизованный пользователь,
**Я хочу** выйти из системы,
**Чтобы** завершить сессию.

**Критерии приемки:**
1. Пользователь может нажать кнопку "Выйти"
2. Сессия пользователя завершается
3. Пользователь перенаправляется на страницу входа

## Управление профилем

### US-6: Просмотр профиля (P1)

**Как** авторизованный пользователь,
**Я хочу** просматривать свой профиль,
**Чтобы** видеть свои данные.

**Критерии приемки:**
1. Пользователь может просматривать свои данные: имя, фамилия, email, компания
2. Пользователь может видеть дату регистрации
3. Пользователь может видеть статус своих подписок и активные коннекторы

### US-7: Редактирование профиля (P1)

**Как** авторизованный пользователь,
**Я хочу** редактировать свой профиль,
**Чтобы** обновлять свои данные.

**Критерии приемки:**
1. Пользователь может изменять свои данные: имя, фамилия, компания
2. Пользователь не может изменять email
3. Система валидирует введенные данные
4. После сохранения изменений пользователь видит сообщение об успешном обновлении

### US-8: Изменение пароля (P1)

**Как** авторизованный пользователь,
**Я хочу** изменить свой пароль,
**Чтобы** обеспечить безопасность своего аккаунта.

**Критерии приемки:**
1. Пользователь должен ввести текущий пароль
2. Пользователь должен ввести новый пароль и его подтверждение
3. Система проверяет сложность нового пароля
4. После изменения пароля пользователь получает уведомление на email
5. После изменения пароля все активные сессии, кроме текущей, завершаются

## Управление подписками

### US-9: Просмотр доступных коннекторов (P0)

**Как** авторизованный пользователь,
**Я хочу** просматривать доступные коннекторы,
**Чтобы** выбрать подходящие для меня.

**Критерии приемки:**
1. Пользователь видит список доступных коннекторов
2. Для каждого коннектора отображается: название, описание, категория, стоимость, период, функции
3. Пользователь может сравнивать коннекторы
4. Текущие подписки пользователя выделены

### US-10: Активация пробного периода (P0)

**Как** новый пользователь,
**Я хочу** активировать пробный период,
**Чтобы** оценить возможности платформы.

**Критерии приемки:**
1. После подтверждения email пользователь может активировать пробный период
2. Пробный период активируется без ввода платежных данных
3. Пробный период длится 7 дней
4. Пользователь получает доступ к выбранным стандартным коннекторам
5. Пользователь видит оставшееся время пробного периода

### US-11: Оформление подписки (P0)

**Как** авторизованный пользователь,
**Я хочу** оформить подписку на коннектор,
**Чтобы** получить доступ к его функциональности.

**Критерии приемки:**
1. Пользователь может выбрать коннектор
2. Пользователь может выбрать период оплаты (месяц, год)

3. Пользователь может ввести платежные данные
4. Система интегрирована со Stripe для обработки платежей
5. После успешной оплаты подписка активируется
6. Пользователь получает email с подтверждением подписки

### US-12: Просмотр текущей подписки (P0)

**Как** авторизованный пользователь,
**Я хочу** просматривать информацию о своей текущей подписке,
**Чтобы** знать её статус и лимиты.

**Критерии приемки:**
1. Пользователь видит информацию о текущих подписках: коннектор, аккаунт Make, статус, дата начала, дата окончания
2. Пользователь видит список активных коннекторов
3. Пользователь видит, включено ли автоматическое продление
4. Пользователь видит историю платежей

### US-13: Отмена подписки (P1)

**Как** авторизованный пользователь с активной подпиской,
**Я хочу** отменить автоматическое продление подписки,
**Чтобы** не продолжать оплату после окончания текущего периода.

**Критерии приемки:**
1. Пользователь может отменить автоматическое продление подписки
2. Система запрашивает подтверждение отмены
3. После отмены подписка остается активной до конца оплаченного периода
4. Пользователь получает email с подтверждением отмены
5. Пользователь видит дату окончания доступа

### US-14: Возобновление подписки (P1)

**Как** авторизованный пользователь с отмененной подпиской,
**Я хочу** возобновить подписку,
**Чтобы** продолжить использование коннекторов.

**Критерии приемки:**
1. Пользователь может возобновить отмененную подписку до истечения оплаченного периода
2. После возобновления автоматическое продление включается
3. Пользователь получает email с подтверждением возобновления
4. Если подписка уже истекла, пользователь должен оформить новую подписку

### US-15: Изменение подписки (P2)

**Как** авторизованный пользователь с активной подпиской,
**Я хочу** изменить свою подписку на коннектор,
**Чтобы** получить доступ к другому коннектору или изменить период оплаты.

**Критерии приемки:**
1. Пользователь может изменить период оплаты коннектора (с месячного на годовой и наоборот)
2. При переходе на годовой период изменения вступают в силу немедленно, с доплатой за оставшийся период
3. При переходе на месячный период изменения вступают в силу после окончания текущего периода
4. Пользователь не может изменить аккаунт Make после создания подписки
5. Пользователь получает email с подтверждением изменения подписки

## Управление API-ключами

### US-16: Получение доступа к коннектору (P0)

**Как** авторизованный пользователь с активной подпиской,
**Я хочу** получить доступ к коннектору,
**Чтобы** использовать его в Make.

**Критерии приемки:**
1. После оформления подписки пользователь получает доступ к коннектору
2. Система автоматически генерирует API-ключ сразу после оформления подписки
3. Коннектор автоматически привязывается к тому аккаунту Make, в котором он будет использован первый раз
4. Пользователь может использовать коннектор в любом количестве сценариев в рамках одного аккаунта Make

### US-17: Просмотр активных коннекторов (P0)

**Как** авторизованный пользователь,
**Я хочу** просматривать список своих активных коннекторов,
**Чтобы** управлять своими подписками.

**Критерии приемки:**
1. Пользователь видит список своих активных коннекторов
2. Для каждого коннектора отображается: название, аккаунт Make, дата окончания подписки
3. Пользователь видит статус каждого коннектора (активен/неактивен)
4. Пользователь может фильтровать и сортировать список коннекторов

### US-18: Отмена подписки на коннектор (P0)

**Как** авторизованный пользователь,
**Я хочу** отменить подписку на коннектор,
**Чтобы** прекратить списания за него.

**Критерии приемки:**
1. Пользователь может отменить подписку на любой из своих коннекторов
2. Перед отменой система запрашивает подтверждение
3. После отмены подписка остается активной до конца оплаченного периода
4. По окончании оплаченного периода коннектор перестает работать
5. Пользователь получает уведомление об успешной отмене подписки

## Использование коннекторов

### US-19: Проверка статуса подписки (P0)

**Как** коннектор Make,
**Я хочу** проверить статус подписки пользователя,
**Чтобы** определить, имеет ли он доступ к функциональности.

**Критерии приемки:**
1. Коннектор отправляет запрос к API с API-ключом пользователя
2. Система проверяет валидность API-ключа
3. Система проверяет статус подписки пользователя
4. Система возвращает информацию о статусе подписки, коннекторе и аккаунте Make, к которому привязан коннектор
5. Если подписка неактивна, система возвращает соответствующую ошибку

### US-20: Регистрация использования коннектора (P0)

**Как** коннектор Make,
**Я хочу** регистрировать использование операций,
**Чтобы** система могла учитывать использование ресурсов.

**Критерии приемки:**
1. Коннектор отправляет запрос к API с информацией об использовании
2. Система регистрирует операцию в базе данных
3. Система обновляет счетчик использованных операций
4. Система проверяет активность подписки
5. Система проверяет, что аккаунт Make соответствует тому, к которому привязан коннектор
6. Если подписка неактивна или аккаунт Make не соответствует, система возвращает соответствующую ошибку

## Панель администратора

### US-21: Просмотр списка пользователей (P1)

**Как** администратор,
**Я хочу** просматривать список всех пользователей,
**Чтобы** управлять ими.

**Критерии приемки:**
1. Администратор видит список всех пользователей
2. Для каждого пользователя отображается: email, имя, фамилия, компания, статус, дата регистрации
3. Администратор может фильтровать пользователей по статусу, дате регистрации
4. Администратор может искать пользователей по email, имени, фамилии, компании

### US-22: Управление пользователями (P1)

**Как** администратор,
**Я хочу** управлять пользователями,
**Чтобы** контролировать доступ к системе.

**Критерии приемки:**
1. Администратор может просматривать детальную информацию о пользователе
2. Администратор может изменять статус пользователя (активировать, блокировать)
3. Администратор может сбрасывать пароль пользователя
4. Администратор не может видеть пароли пользователей

### US-23: Просмотр подписок (P1)

**Как** администратор,
**Я хочу** просматривать подписки пользователей,
**Чтобы** контролировать доступ к коннекторам.

**Критерии приемки:**
1. Администратор видит список всех подписок
2. Для каждой подписки отображается: пользователь, коннектор, аккаунт Make, статус, даты начала и окончания
3. Администратор может фильтровать подписки по статусу, коннектору, датам
4. Администратор может искать подписки по email пользователя

### US-24: Управление коннекторами (P2)

**Как** администратор,
**Я хочу** управлять коннекторами,
**Чтобы** настраивать предложения для пользователей.

**Критерии приемки:**
1. Администратор может создавать новые коннекторы
2. Администратор может редактировать существующие коннекторы
3. Администратор может деактивировать коннекторы (они не будут доступны для новых подписок)
4. Администратор не может удалять коннекторы, на которые есть активные подписки

### US-25: Просмотр статистики использования (P2)

**Как** администратор,
**Я хочу** просматривать статистику использования коннекторов,
**Чтобы** анализировать активность пользователей.

**Критерии приемки:**
1. Администратор видит общую статистику использования коннекторов
2. Администратор может фильтровать статистику по коннекторам, операциям, датам
3. Администратор может просматривать статистику по конкретному пользователю
4. Администратор видит графики использования

## Приоритизация User Stories для MVP

### Критически важные (P0)
- US-1: Регистрация нового пользователя
- US-2: Подтверждение email
- US-3: Вход в систему
- US-5: Выход из системы
- US-9: Просмотр доступных коннекторов
- US-10: Активация пробного периода
- US-11: Оформление подписки
- US-12: Просмотр текущей подписки
- US-16: Получение доступа к коннектору
- US-17: Просмотр активных коннекторов
- US-18: Отмена подписки на коннектор
- US-19: Проверка статуса подписки
- US-20: Регистрация использования коннектора

### Важные (P1)
- US-4: Восстановление пароля
- US-6: Просмотр профиля
- US-7: Редактирование профиля
- US-8: Изменение пароля
- US-13: Отмена подписки
- US-14: Возобновление подписки
- US-21: Просмотр списка пользователей
- US-22: Управление пользователями
- US-23: Просмотр подписок

### Желательные (P2)
- US-15: Изменение подписки
- US-24: Управление коннекторами
- US-25: Просмотр статистики использования

## Пользовательские сценарии

### Сценарий 1: Регистрация и активация пробного периода

1. Гость заходит на сайт BPM Centr
2. Гость нажимает кнопку "Регистрация"
3. Гость заполняет форму регистрации
4. Система отправляет email с ссылкой для подтверждения
5. Гость переходит по ссылке из email
6. Система активирует учетную запись
7. Пользователь входит в систему
8. Система предлагает активировать пробный период
9. Пользователь выбирает интересующие его стандартные коннекторы
10. Система автоматически генерирует API-ключи для выбранных коннекторов
11. Система активирует пробный период на 7 дней и перенаправляет в личный кабинет

### Сценарий 2: Оформление подписки

1. Пользователь входит в систему
2. Пользователь переходит в раздел "Коннекторы"
3. Пользователь выбирает подходящий коннектор
4. Пользователь нажимает кнопку "Оформить подписку"
5. Пользователь выбирает период оплаты
6. Пользователь вводит платежные данные
7. Система обрабатывает платеж через Stripe
8. Система активирует подписку
9. Система отправляет email с подтверждением подписки
10. Система перенаправляет пользователя в личный кабинет

### Сценарий 3: Использование коннектора в Make

1. Пользователь оформляет подписку на коннектор
2. Пользователь переходит в Make
3. Пользователь создает новый сценарий в Make
4. Пользователь добавляет коннектор в сценарий
5. Пользователь получает автоматически сгенерированный API-ключ сразу после оформления подписки
6. Коннектор автоматически привязывается к текущему аккаунту Make
7. Коннектор отправляет запрос к API для проверки подписки
8. Система проверяет статус подписки и соответствие аккаунта Make
9. Коннектор выполняет операцию и регистрирует использование
10. Пользователь может использовать коннектор в любом количестве сценариев в рамках этого аккаунта Make
